{% extends "base.html" %}

{% block main %}

{% load static %}

<title> Index </title>

<main>
	<h1> Documentation </h1>

	<h2> Crossing Introduction </h2>

	The crossing block ("WCP") is an annual activity that initiates the breeding program pipeline. The inputs of the crossing block are inbred lines, chosen to be parents due to performance, predictions, or as carriers of novel genes. The outputs are crosses, records of physical pairings between emasculated and non-emasculated plants, the families generated from succesful pairings (containing information from both parents), and physical seed stocks generated as the emasculated head sets grain in a succesful cross. All breeding program lines generated by the LSU wheat breeding program have their origin in these cross events, and need to carry forward information relating to that event and the component parents, and the physical expression of lines as seed stocks and plots have their origin in the F1 seed lots generated from a crossing event. We will attempt to organize this information in a way that allows for:

	<ul>
		<li> Easy tracking and retrieval of parental information in future years as line advance through the breeding program </li>
		<li> Maintain easily queryable records of the physical cross events made within different years' WCPs, and the eventual status of those crosses, in a way that both allows for tracking of progress within a year and creates easy access to historic records for future years</li> 
		<li> Queryable by web app and R applications for guiding crossing decisions based on WCP genes/notes and failed/succesful cross records </li>
		<li> Accept recorded cross information from the intercross app exports </li>
		<li> Automatically generates familly information (family name, family segregating genes, purdy pedigree information) automatically on cross success </li>
		<li> Terminates in the generation of a seed stock which can be used as an input into the nursery creation tool for creating F1 plots </li>
	</ul>

	This is the first year, so we will see what works and what we need to change as we go!

	<h2> DB Background </h2>

	The database background is a lightweight SQLLite instance, stored as a single file on the server in Sturgis. This SQLlite instance is easy to query directly with R, without having to download the file as a CSV or convert to an Excel file:

	<img> </img>


	Direct writing to the DB is discouraged. Most aspects of the LSU SG web app serve as a graphical front end for accessing and modifying the underlying DB along set paths defined by traditional work flows in the breeding program. The only pure inputs into the database are each year's WCP entries, record of succesful crosses, records of weights and quantities of seed stocks (generated from plots DB table), and selection records to generate new seed stocks from plots. 

	The LSU SG web app is built on the DJango python library and associated tools, as an intermediate layer that communicates with the SQLLite server on the back-end, and proceduarlly generates HTML through encoded templates to create a front-end graphical interface for displaying and editing information.

	<h2> Crossing Workflow </h2>

	At the beginning of the crossing season, information on all potential parents are uploaded into the WCP:

	Individual WCP entries can be viewed in detail by filtering and viewing individual rows:

	(In future years, there will be a configurable toggle that will default to the current year to prevent display and use of multiple years' WCP entries). 

	Edits can be made by...

	<img> </img>

	Because future crosses parents are recorded as being associated with the WCP database entry itself, any changes to the notes/genes/etc in this panel will be forward-propogated to all future plots, seed lots, etc of any WCP progeny.

	The intended crossing workflow begins at the parental selection stage. An R-Shiny web app has been written to hook into the underlying DB and allow for in-person crossing selections based on parental availability. This method combined aspects of crossing protocols developed by Stephen Harrison at LSU, Paul Murphy at NCSU, and Jessicar Rutkoski at UI. The work pain consists of three primary panels:

	<img> </img>

	The left-most top pane pulls in information from the WCP entry table and displays individual names. The intended workflow is to walk forward from the beginning to the end of the parent table and record availability of male and female parents by clicking on the "+" button associated with each row. With each additional line, a heatmap relating the value and status of potential crosses is displayed in the right pane:

	<img> </img>

	The cell values are a measure of genetic merit (Usefulness criterion; UC) of the cross whose value is a function of the genomic predictions-derived selection index for each WCP entry, and the pairwise kinship between two entries (penalizing close relatives in crossing). This is approximately a popvar style value of the predicted top 10% of each cross. This value is adjusted downward for those lines (germplasm; G group) which are included for some reason (generally becuase they cary some novel or useful gene), but generally do not have genomic predictions available, so that we prioritize crosses with the most elite predicted set. Os overlaid onto a tile indicate the cross has already been made, and an X indicates a cross has been made but that that cross failed to set seed. The heatmap values serve as a first approximation of the relative merit of the cross, to be checked in the detail view after selection of a cross. This is done by clicking on a tile, which removes one male and one female from the potential crossing pool (top left pane), and proceduarlly generates cross information:

	<img>

	A purdy pedigree is generated based on a search through the parents' pedigrees for the highest level of cross, and a string containing major genes of the parents is displayed. An overall selection index merit, and FHB-specific seleciton index merit, and a kinship (k) are all displayed -- while they together are used as inputs into the UC values displayed in the cross, they should be checked prior to crossing. The "-" button allows for the removal of a cross and the re-entry of the selected lines back into the heatmap and potential parental pool.

	Potential crosses are accumulated in the bottom pane until all desired crosses are made or the parental pool on that day is exhausted. These crosses are moved to a bench to be set up:


	One distinction is that cross records as targets are generated *after* a cross has been set up, instead of prior to a cross being set up. The bottom papne of the crossing app never is downloaded or pushed into the DB, just used to suggest a physical pairing of pots in the GH. After a physical pairing is made, it is assigned an incrementing target number (TYYNNN, eg T24008), and read into the intercross app using the barcodes placed on the labels on WCP entries:


</main>
{% endblock %}
